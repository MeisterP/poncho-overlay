From 558a3af8cdc99380549e1c9c1b91ce00faadfffc Mon Sep 17 00:00:00 2001
From: Poncho <poncho@spahan.ch>
Date: Tue, 21 May 2024 23:31:53 +0200
Subject: [PATCH] qwt: fix  QwtLegend colors with qt > 6.7

Cherry-pick commit 1e10def87dfc021a7fbb1df233f435dfac9c36b5 from upstream qwt.
Will be part of version 6.3

Upstream issue: https://sourceforge.net/p/qwt/bugs/374/
Closes: https://github.com/GoldenCheetah/GoldenCheetah/issues/4495
---
 qwt/src/qwt_null_paintdevice.cpp | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

diff --git a/qwt/src/qwt_null_paintdevice.cpp b/qwt/src/qwt_null_paintdevice.cpp
index 922b32daa..f438e1ab5 100644
--- a/qwt/src/qwt_null_paintdevice.cpp
+++ b/qwt/src/qwt_null_paintdevice.cpp
@@ -463,11 +463,20 @@ int QwtNullPaintDevice::metric( PaintDeviceMetric deviceMetric ) const
             value = qRound( metric( PdmHeight ) * 25.4 / metric( PdmDpiY ) );
             break;
         }
+#if QT_VERSION >= 0x050100
+        case PdmDevicePixelRatio:
+        {
+            value = 1.0;
+            break;
+        }
+#endif
         default:
-            value = 0;
+        {
+            value = QPaintDevice::metric( deviceMetric );
+        }
     }
-    return value;
 
+    return value;
 }
 
 //! See QPaintEngine::drawRects()
-- 
2.44.1

